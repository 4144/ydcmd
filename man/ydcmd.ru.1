.TH ydcmd 1 "22 Июля 2014"
.nh
.ad left
.SH НАЗВАНИЕ
ydcmd \- консольный клиент для работы с облачным хранилищем Яндекс.Диск посредством REST API.
.SH СИНТАКСИС
.B ydcmd
.RI [ command ] " " [ options ] " " [ args ]
.SH КОМАНДЫ
.TP
.B help
Получение краткой справки по командам и опциям приложения.
.TP
.B ls
Получение списка файлов и директорий.
.TP
.B rm
Удаление файла или директории.
.TP
.B cp
Копирование файла или директории.
.TP
.B mv
Перемещение файла или директории.
.TP
.B put
Загрузка файла или директории в хранилище.
.TP
.B get
Получение файла или директории из хранилища.
.TP
.B mkdir
Создание директории.
.TP
.B stat
Получение метаинформации об объекте.
.TP
.B info
Получение метаинформации о хранилище.
.TP
.B last
Получение метаинформации о последних загруженных файлах.
.TP
.B du
Оценка места, занимаемого файлами в хранилище.
.TP
.B clean
Очистка файлов и директорий.
.SH ОПЦИИ
.TP
.B --timeout=<N>
Таймаут в секундах на установку сетевого соединения.
.TP
.B --retries=<N>
Количество попыток вызова метода api перед возвратом кода ошибки.
.TP
.B --delay=<N>
Таймаут между попытками вызова метода api в секундах.
.TP
.B --limit=<N>
Количество элементов, возвращаемое одним вызовом метода получения списка файлов и директорий.
.TP
.B --token=<S>
OAuth токен (в целях безопасности рекомендуется указывать в конфигурационном файле или через переменную окружения YDCMD_TOKEN). Инструкцию по получению отладочного токена можно найти на странице http://api.yandex.ru/oauth/doc/dg/tasks/get-oauth-token.xml.
.TP
.B --quiet
Подавление вывода об ошибках.
.TP
.B --verbose
Вывод расширенной информации.
.TP
.B --debug
Вывод отладочной информации.
.TP
.B --chunk=<N>
Размер блока данных в КБ для операций ввода/вывода.
.TP
.B --ca-file=<S>
Имя файла с сертификатами доверенных центров сертификации (при пустом значении проверка валидности сертификата не производится).
.TP
.B --ciphers=<S>
Набор алгоритмов шифрования (см. ciphers(1)).
.SH ДОПОЛНИТЕЛЬНЫЕ ОПЦИИ
.SS ls
.TP
.B --human
Вывод размера файла в человеко-читаемом виде.
.TP
.B --short
Вывод списка файлов и директорий без дополнительной информации (одно имя в одну строку).
.TP
.B --long
Вывод расширенного списка (время создания, время модификации, размер, имя файла).
.TP
Если целевой объект не указан, то будет использоваться корневая директория хранилища.
.SS rm
.TP
.B --poll=<N>
Время в секундах между опросом состояния при выполнении асинхронной операции.
.TP
.B --async
Выполнение команды без ожидания завершения (poll) операции.
.TP
Файлы удаляются без возможности восстановления. Директории удаляются рекурсивно (включая вложенные файлы и директории).
.SS cp
.TP
.B --poll=<N>
Время в секундах между опросом состояния при выполнении асинхронной операции.
.TP
.B --async
Выполнение команды без ожидания завершения (poll) операции.
.TP
В случае совпадения имен, директории и файлы будут перезаписаны. Директории копируются рекурсивно (включая вложенные файлы и директории).
.SS mv
.TP
.B --poll=<N>
Время в секундах между опросом состояния при выполнении асинхронной операции.
.TP
.B --async
Выполнение команды без ожидания завершения (poll) операции.
.TP
В случае совпадения имени, директории и файлы будут перезаписаны.
.SS put
.TP
.B --rsync
Синхронизация дерева файлов и директорий в хранилище с локальным деревом
.TP
.B --encrypt
Шифрование файлов при помощи --encrypt-cmd перед операцией загрузки в хранилище.
.TP
.B --encrypt-cmd
Команда получающая на stdin содержимое локального (нешифрованного) файла и отдающее в stdout его шифрованную версию.
.TP
.B --temp-dir
Директория для хранения временных зашифрованных файлов.
.TP
Если целевой объект не указан, то для загрузки файла будет использоваться корневая директория хранилища. Если целевой объект указывает на директорию (заканчивается на '/'), то к имени директории будет добавлено имя исходного файла. Если целевой объект существует, то он будет перезаписан без запроса подтверждения. Символические ссылки игнорируются.
.SS get
.TP
.B --rsync
Синхронизация локального дерева файлов и директорий с деревом в хранилище.
.TP
.B --decrypt
Расшифровка файлов при помощи --decrypt-cmd после операции получения из хранилища.
.TP
.B --decrypt-cmd
Команда получающая на stdin содержимое шифрованного файла из хранилища и отдающее в stdout его дешифрованную версию.
.TP
.B --temp-dir
Директория для хранения временных зашифрованных файлов.
.TP
Если не указано имя целевого файла, будет использовано имя файла в хранилище. Если целевой объект существует, то он будет перезаписан без запроса подтверждения.
.SS info
.TP
.B --long
Отображать размеры в байтах вместо человеко-читаемого вида.
.SS last
.TP
.B --human
Вывод размера файла в человеко-читаемом виде.
.TP
.B --short
Вывод списка файлов без дополнительной информации (одно имя в одну строку).
.TP
.B --long
Вывод расширенного списка (время создания, время модификации, размер, имя файла).
.TP
Если параметр N не задан, будет использовано значение по умолчанию из REST API.
.SS du
.TP
.B --depth=<N>
Отображать размеры директорий до уровня N.
.TP
.B --long
Отображать размеры в байтах вместо человеко-читаемого вида.
.TP
Если целевой объект не указан, то будет использоваться корневая директория хранилища.
.SS clean
.TP
.B --dry
Не выполнять удаление, а вывести список объектов для удаления.
.TP
.B --type=<S>
Тип объектов для удаления ('file' - файлы, 'dir' - директории, 'all' - все).
.TP
.B --keep=<S>
Критерий выборки объектов, которые требуется сохранить:
.br
* Для выбора даты до которой требуется удалить данные, можно использовать строку даты в формате ISO (например, '2014-02-12T12:19:05+04:00');
.br
* Для выбора относительного времени, можно использовать число и размерность (например, '7d', '4w', '1m', '1y');
.br
* Для выбора количества копий, можно использовать число без размерности (например, '31').
.SH КОНФИГУРАЦИЯ
.TP
Для удобства работы рекомендуется создать конфигурационный файл с именем ~/.ydcmd.cfg и установить на него права 0600 или 0400. Формат файла:
.P
.RS
[ydcmd]
.br
# комментарий
.br
<option> = <value>
.RE
.TP
Например:
.P
.RS
[ydcmd]
.br
token   = 1234567890
.br
verbose = yes
.br
ca-file = /etc/ssl/certs/ca-certificates.crt
.RE
.SH ПЕРЕМЕННЫЕ ОКРУЖЕНИЯ
.TP
.B YDCMD_TOKEN
OAuth токен. Имеет приоритет перед опцией --token.
.SH КОД ВЫХОДА
.TP
.B 0
Успешное завершение.
.TP
.B 1
Общая ошибка приложения.
.TP
.B 4
Код состояния HTTP-4xx (ошибка клиента).
.TP
.B 5
Код состояния HTTP-5xx (ошибка сервера).
